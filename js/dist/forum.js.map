{"version":3,"sources":["webpack://@clarkwinkelmann/catch-the-fish/webpack/bootstrap","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['forum/app']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/Model']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/components/Button']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/extend']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/components/Modal']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/components/LinkButton']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/utils/extractText']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/components/Page']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/components/Switch']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/models/Forum']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/utils/withAttr']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/models/User']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/models/Discussion']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/models/Post']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['forum/components/HeaderPrimary']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['forum/components/CommentPost']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['forum/components/UserCard']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['forum/components/DiscussionHero']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/utils/classList']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/components/Link']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/helpers/avatar']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/helpers/username']\"","webpack://@clarkwinkelmann/catch-the-fish/./node_modules/dayjs/plugin/calendar.js","webpack://@clarkwinkelmann/catch-the-fish/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@clarkwinkelmann/catch-the-fish/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/models/Fish.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/models/Ranking.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/models/Round.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/FishImage.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/Basket.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/DropArea.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/User.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/modals/CaughtFishModal.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/MovingFish.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/addDropAreas.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/RoundRankings.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/pages/Rankings.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/EditRound.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/modals/NewRoundModal.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/modals/EditRoundModal.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/pages/RoundList.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/EditFish.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/modals/NewFishModal.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/modals/EditFishModal.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/pages/RoundSettings.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/RoundAlert.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/index.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/addModels.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/addFishBasket.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/addPages.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/addNavLinks.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/addRoundAlert.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","flarum","core","compat","e","a","lastDay","sameDay","nextDay","nextWeek","lastWeek","sameElse","calendar","this","$locale","startOf","diff","f","format","_setPrototypeOf","setPrototypeOf","__proto__","_inheritsLoose","subClass","superClass","constructor","Fish","round_id","Model","attribute","placement","image_url","canSee","canCatch","canName","canPlace","placeUntil","namedBy","hasOne","placedBy","round","apiEndpoint","exists","data","id","attributes","Ranking","catch_count","user","Round","starts_at","ends_at","include_starting_pack","ranking","FishImage","view","vnode","src","attrs","fish","alt","extractText","app","translator","trans","translationPrefix","style","animationDuration","Basket","session","basket","catchTheFishBasket","fishesThatCanBePlaced","filter","length","map","draggable","ondragstart","event","dataTransfer","setData","time","dayjs","fromNow","DropArea","User","Link","href","route","avatar","username","CaughtFishModal","newName","dirty","loading","oninit","className","title","saveNameAndPlacement","randomPlacement","body","request","method","url","forum","then","result","store","pushPayload","hide","find","redraw","err","content","oninput","target","Button","component","type","onclick","onsubmit","preventDefault","Modal","MovingFish","reverseAnimation","Math","random","floor","classList","catchTheFishAnimateFlip","modal","show","oncatch","alert","fishIdFromEvent","getData","match","exec","movingFishContent","dragover","model","push","fishes","catchTheFishFishes","forEach","pushData","relationships","addDropAttrs","modelProperty","ondrop","fishDragOver","fishId","getById","ondragover","dropEffect","ondragenter","ondragleave","addAreaToComponent","viewName","override","concat","extend","items","add","subtree","check","vdom","RoundRankings","rankings","index","Rankings","catchTheFishCanSeeRankingsPage","rounds","catchTheFishActiveRounds","Page","EditRound","processing","createRecord","toISOString","saveRecord","withAttr","updateAttribute","Switch","state","onchange","disabled","readyToSave","deleteRecord","pushAttributes","save","onsave","confirm","ondelete","NewRoundModal","oncreateordelete","EditRoundModal","RoundList","refreshRounds","LinkButton","EditFish","NewFishModal","RoundSettings","roundId","uploading","param","refreshFishes","openPicker","callback","multiple","$input","$","attr","appendTo","click","on","files","uploadImages","images","FormData","append","serialize","raw","EditFishModal","UpdateAlert","initializers","models","Discussion","hasMany","Post","Forum","catchTheFishCanModerate","catchTheFishCanSeeProfileRankings","HeaderPrimary","CommentPost","UserCard","DiscussionHero","routes","catchTheFishRankings","path","catchTheFishRounds","catchTheFishRound","IndexPage","icon","original","existing","additional","RoundAlert","Array","isArray"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 25);\n","module.exports = flarum.core.compat['forum/app'];","module.exports = flarum.core.compat['common/Model'];","module.exports = flarum.core.compat['common/components/Button'];","module.exports = flarum.core.compat['common/extend'];","module.exports = flarum.core.compat['common/components/Modal'];","module.exports = flarum.core.compat['common/components/LinkButton'];","module.exports = flarum.core.compat['common/utils/extractText'];","module.exports = flarum.core.compat['common/components/Page'];","module.exports = flarum.core.compat['common/components/Switch'];","module.exports = flarum.core.compat['common/models/Forum'];","module.exports = flarum.core.compat['forum/components/IndexPage'];","module.exports = flarum.core.compat['common/utils/withAttr'];","module.exports = flarum.core.compat['common/models/User'];","module.exports = flarum.core.compat['common/models/Discussion'];","module.exports = flarum.core.compat['common/models/Post'];","module.exports = flarum.core.compat['forum/components/HeaderPrimary'];","module.exports = flarum.core.compat['forum/components/CommentPost'];","module.exports = flarum.core.compat['forum/components/UserCard'];","module.exports = flarum.core.compat['forum/components/DiscussionHero'];","module.exports = flarum.core.compat['common/utils/classList'];","module.exports = flarum.core.compat['common/components/Link'];","module.exports = flarum.core.compat['common/helpers/avatar'];","module.exports = flarum.core.compat['common/helpers/username'];","!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):(e=\"undefined\"!=typeof globalThis?globalThis:e||self).dayjs_plugin_calendar=t()}(this,(function(){\"use strict\";return function(e,t,a){var n=\"h:mm A\",d={lastDay:\"[Yesterday at] \"+n,sameDay:\"[Today at] \"+n,nextDay:\"[Tomorrow at] \"+n,nextWeek:\"dddd [at] \"+n,lastWeek:\"[Last] dddd [at] \"+n,sameElse:\"MM/DD/YYYY\"};t.prototype.calendar=function(e,t){var n=t||this.$locale().calendar||d,o=a(e||void 0).startOf(\"d\"),s=this.diff(o,\"d\",!0),i=\"sameElse\",f=s<-6?i:s<-1?\"lastWeek\":s<0?\"lastDay\":s<1?\"sameDay\":s<2?\"nextDay\":s<7?\"nextWeek\":i,l=n[f]||d[f];return\"function\"==typeof l?l.call(this,a()):this.format(l)}}}));","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import Model from 'flarum/common/Model';\nimport User from 'flarum/common/models/User';\n\nexport default class Fish extends Model {\n    round_id = Model.attribute('round_id'); // Just for the creation apiEndpoint creation\n    placement = Model.attribute('placement'); // Object\n    name = Model.attribute('name');\n    image_url = Model.attribute('image_url');\n    canSee = Model.attribute('canSee');\n    canCatch = Model.attribute('canCatch');\n    canName = Model.attribute('canName');\n    canPlace = Model.attribute('canPlace');\n    placeUntil = Model.attribute('placeUntil');\n    namedBy: () => User | false = Model.hasOne('lastUserNaming');\n    placedBy: () => User | false = Model.hasOne('lastUserPlacement');\n    round = Model.hasOne('round');\n\n    apiEndpoint() {\n        return '/catch-the-fish/' + (this.exists ? 'fishes/' + this.data.id : 'rounds/' + this.data.attributes.round_id + '/fishes');\n    }\n}\n","import Model from 'flarum/common/Model';\nimport User from 'flarum/common/models/User';\n\nexport default class Ranking extends Model {\n    catch_count = Model.attribute('catch_count');\n    user: () => User = Model.hasOne('user');\n}\n","import Model from 'flarum/common/Model';\n\nexport default class Round extends Model {\n    name = Model.attribute('name');\n    starts_at = Model.attribute('starts_at');\n    ends_at = Model.attribute('ends_at');\n    include_starting_pack = Model.attribute('include_starting_pack');\n    ranking = Model.hasOne('ranking');\n\n    apiEndpoint() {\n        return '/catch-the-fish/rounds' + (this.exists ? '/' + this.data.id : '');\n    }\n}\n","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport extractText from 'flarum/common/utils/extractText';\nimport Fish from '../models/Fish';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.fish-image.';\n\ninterface FishImageAttrs {\n    fish: Fish\n    animationDuration?: string\n}\n\nexport default class FishImage implements ClassComponent<FishImageAttrs> {\n    view(vnode: Vnode<FishImageAttrs, this>) {\n        const src = vnode.attrs.fish.image_url();\n\n        if (src) {\n            return m('img.catchthefish-image', {\n                alt: extractText(app.translator.trans(translationPrefix + 'alt', {\n                    name: vnode.attrs.fish.name(),\n                })),\n                src,\n                style: {\n                    animationDuration: vnode.attrs.animationDuration || '10s',\n                },\n            });\n        }\n\n        return m('.catchthefish-no-image', app.translator.trans(translationPrefix + 'missing'));\n    }\n}\n","import {ClassComponent} from 'mithril';\nimport app from 'flarum/forum/app';\nimport User from 'flarum/common/models/User';\nimport FishImage from './FishImage';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.basket.';\n\nexport default class Basket implements ClassComponent {\n    view() {\n        if (!app.session.user) {\n            return m('div');\n        }\n\n        const basket = (app.session.user as User).catchTheFishBasket();\n\n        if (!basket) {\n            return m('div');\n        }\n\n        const fishesThatCanBePlaced = basket.filter(fish => fish.canPlace());\n\n        if (fishesThatCanBePlaced.length === 0) {\n            return m('div');\n        }\n\n        return m('.catchthefish-basket', [\n            m('.catchthefish-basket-title', app.translator.trans(translationPrefix + 'title')),\n            m('p', app.translator.trans(translationPrefix + 'drag-help')),\n            fishesThatCanBePlaced.map(fish => m('.catchthefish-basket-entry', [\n                m('.catchthefish-basket-fish', {\n                    draggable: true,\n                    ondragstart(event: DragEvent) {\n                        if (!event.dataTransfer) {\n                            return;\n                        }\n\n                        event.dataTransfer.setData('text/plain', 'fish:' + fish.id());\n                    },\n                }, m(FishImage, {\n                    fish,\n                })),\n                m('.catchthefish-basket-time', app.translator.trans(translationPrefix + 'time', {\n                    time: dayjs(fish.placeUntil()).fromNow(),\n                })),\n            ])),\n        ]);\n    }\n}\n","import {ClassComponent} from 'mithril';\nimport app from 'flarum/forum/app';\n\nexport default class DropArea implements ClassComponent {\n    view() {\n        return m('.catchthefish-drop-area', app.translator.trans('clarkwinkelmann-catch-the-fish.forum.drop-area.message'));\n    }\n}\n","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport Link from 'flarum/common/components/Link';\nimport avatar from 'flarum/common/helpers/avatar';\nimport username from 'flarum/common/helpers/username';\nimport UserModel from 'flarum/common/models/User';\n\ninterface UserAttrs {\n    user: UserModel\n}\n\nexport default class User implements ClassComponent<UserAttrs> {\n    view(vnode: Vnode<UserAttrs, this>) {\n        const {user} = vnode.attrs;\n\n        return m(Link, {\n            href: app.route.user(user),\n        }, [\n            avatar(user),\n            ' ',\n            username(user),\n        ]);\n    }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport FishImage from '../components/FishImage';\nimport User from \"../components/User\";\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.caught-fish-modal.';\n\nexport default class CaughtFishModal extends Modal {\n    newName!: string\n    dirty: boolean = false\n    loading: boolean = false\n\n    oninit(vnode) {\n        super.oninit(vnode);\n\n        this.newName = this.attrs.fish.name();\n    }\n\n    className() {\n        return 'Modal--small catchthefish-catch-modal';\n    }\n\n    title() {\n        return app.translator.trans(translationPrefix + 'title');\n    }\n\n    saveNameAndPlacement(randomPlacement = false) {\n        const body: any = {};\n\n        if (this.dirty) {\n            body.name = this.newName;\n        }\n\n        if (randomPlacement) {\n            body.placement = 'random';\n        }\n\n        if (body) {\n            this.loading = true;\n\n            app.request({\n                method: 'POST',\n                url: app.forum.attribute('apiUrl') + '/catch-the-fish/fishes/' + this.attrs.fish.id() + '/place',\n                body,\n            }).then(result => {\n                app.store.pushPayload(result);\n                this.hide();\n\n                if (this.attrs.fish.canPlace() && !randomPlacement) {\n                    // Refresh basket by reloading user\n                    app.store.find('users', app.session.user.id()).then(() => {\n                        m.redraw();\n                    });\n                }\n            }).catch(err => {\n                this.loading = false;\n                m.redraw();\n                throw err;\n            });\n        } else {\n            this.hide();\n\n            if (this.attrs.fish.canPlace() && !randomPlacement) {\n                // Refresh basket by reloading user\n                app.store.find('users', app.session.user.id()).then(() => {\n                    m.redraw();\n                });\n            }\n        }\n    }\n\n    content() {\n        const {fish} = this.attrs;\n\n        const namedBy = fish.namedBy();\n        const placedBy = fish.placedBy();\n\n        return m('.Modal-body', [\n            m('h3', '\"' + fish.name() + '\"'),\n            m(FishImage, {\n                fish,\n            }),\n            namedBy ? m('p', [\n                app.translator.trans(translationPrefix + 'named-by'),\n                ' ',\n                m(User, {\n                    user: namedBy,\n                }),\n            ]) : null,\n            placedBy ? m('p', [\n                app.translator.trans(translationPrefix + 'placed-by'),\n                ' ',\n                m(User, {\n                    user: placedBy,\n                }),\n            ]) : null,\n            m('p', app.translator.trans(translationPrefix + 'congratulation', {\n                catch_count: fish.round().ranking().catch_count(),\n            })),\n            fish.canName() ? m('.Form-group', [\n                m('p', app.translator.trans(translationPrefix + 'name-help')),\n                m('label', app.translator.trans(translationPrefix + 'name')),\n                m('input.FormControl', {\n                    value: this.newName,\n                    oninput: event => {\n                        this.newName = event.target.value;\n                        this.dirty = true;\n                    },\n                }),\n            ]) : null,\n            fish.canPlace() ? m('p', app.translator.trans(translationPrefix + 'placement-help')) : null,\n            m('.Form-group', Button.component({\n                className: 'Button Button--primary Button--block',\n                type: 'button',\n                loading: this.loading,\n                onclick: () => {\n                    this.saveNameAndPlacement();\n                },\n            }, app.translator.trans(translationPrefix + (this.dirty ? (fish.canPlace() ? 'submit-name-place-later' : 'submit-name') : (fish.canPlace() ? 'submit-place-later' : 'submit-continue'))))),\n            fish.canPlace() ? m('.Form-group', Button.component({\n                className: 'Button Button--primary Button--block',\n                type: 'button',\n                loading: this.loading,\n                onclick: () => {\n                    this.saveNameAndPlacement(true);\n                },\n            }, app.translator.trans(translationPrefix + (this.dirty ? 'submit-name-place-random' : 'submit-place-random')))) : null,\n        ]);\n    }\n\n    onsubmit(event) {\n        event.preventDefault();\n        // Because the modal has its own form, pressing enter will submit here\n        // In this case we apply the same feature as the first button\n        this.saveNameAndPlacement();\n    }\n}\n","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport classList from 'flarum/common/utils/classList';\nimport FishImage from './FishImage';\nimport CaughtFishModal from '../modals/CaughtFishModal';\nimport Fish from '../models/Fish';\n\ninterface MovingFishAttrs {\n    fish: Fish\n    oncatch?: () => void\n}\n\nexport default class MovingFish implements ClassComponent<MovingFishAttrs> {\n    reverseAnimation!: boolean\n    animationDuration!: string\n\n    oninit() {\n        this.reverseAnimation = Math.random() > 0.5;\n        this.animationDuration = 5 + (Math.floor(Math.random() * 70) / 10) + 's';\n    }\n\n    view(vnode: Vnode<MovingFishAttrs, this>) {\n        const {fish} = vnode.attrs;\n\n        return m('.catchthefish-moving-fish', {\n            className: classList({\n                'catchthefish-animate-flip': app.forum.catchTheFishAnimateFlip(),\n                'catchthefish-animate-reverse': this.reverseAnimation,\n            }),\n            style: {\n                animationDuration: this.animationDuration,\n            },\n            onclick: () => {\n                if (!fish.canCatch() && !app.session.user) {\n                    alert(app.translator.trans('clarkwinkelmann-catch-the-fish.forum.moving-fish.login'));\n                    return;\n                }\n\n                app.request({\n                    method: 'POST',\n                    url: app.forum.attribute('apiUrl') + '/catch-the-fish/fishes/' + fish.id() + '/catch',\n                    body: fish.placement(),\n                }).then(result => {\n                    app.modal.show(CaughtFishModal, {\n                        fish: app.store.pushPayload(result),\n                    });\n\n                    // So the parent can remove the fish from the relationship\n                    if (vnode.attrs.oncatch) {\n                        vnode.attrs.oncatch();\n                    }\n                });\n            },\n        }, [\n            m('.catchthefish-name', fish.name()),\n            m(FishImage, {\n                fish,\n                animationDuration: this.animationDuration,\n            }),\n        ]);\n    }\n}\n","import {extend, override} from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport CommentPost from 'flarum/forum/components/CommentPost';\nimport UserCard from 'flarum/forum/components/UserCard';\nimport DiscussionHero from 'flarum/forum/components/DiscussionHero';\nimport DropArea from './components/DropArea';\nimport MovingFish from './components/MovingFish';\n\nfunction fishIdFromEvent(event: DragEvent): string | null {\n    if (!event.dataTransfer) {\n        return null;\n    }\n\n    const data = event.dataTransfer.getData(\"text/plain\");\n\n    const match = /^fish:([0-9]+)$/.exec(data);\n\n    return match ? match[1] : null;\n}\n\nfunction movingFishContent(dragover: boolean, model) {\n    const content = [];\n\n    if (dragover) {\n        content.push(m(DropArea));\n    }\n\n    const fishes = model.catchTheFishFishes();\n\n    if (fishes) {\n        fishes.forEach(fish => {\n            if (!fish.canSee()) {\n                return;\n            }\n\n            // Remove fish from relationship\n            content.push(m(MovingFish, {\n                fish,\n                oncatch: () => {\n                    model.pushData({\n                        relationships: {\n                            catchTheFishFishes: {\n                                data: model.data.relationships.catchTheFishFishes.data.filter(f => f.id !== fish.id()),\n                            },\n                        },\n                    });\n                },\n            }));\n        });\n    }\n\n    return content;\n}\n\nfunction addDropAttrs(attrs, modelProperty) {\n    attrs.ondrop = event => {\n        this.fishDragOver = false;\n        const fishId = fishIdFromEvent(event);\n\n        if (fishId) {\n            event.preventDefault();\n\n            const fish = app.store.getById('catchthefish-fishes', fishId);\n\n            if (fish) {\n                const placement = {};\n                placement[modelProperty + '_id'] = this.attrs[modelProperty].id();\n\n                app.request({\n                    method: 'POST',\n                    url: app.forum.attribute('apiUrl') + '/catch-the-fish/fishes/' + fish.id() + '/place',\n                    body: {\n                        placement,\n                    },\n                }).then(result => {\n                    app.store.pushPayload(result);\n\n                    // Refresh basket by reloading user\n                    app.store.find('users', app.session.user.id()).then(() => {\n                        m.redraw();\n                    });\n                });\n            } else {\n                alert(app.translator.trans('clarkwinkelmann-catch-the-fish.forum.drop-area.missing-from-store'));\n            }\n        }\n    };\n    attrs.ondragover = event => {\n        const fishId = fishIdFromEvent(event);\n\n        if (fishId) {\n            event.preventDefault();\n            event.dataTransfer.dropEffect = 'move';\n            this.fishDragOver = true;\n        }\n    };\n    attrs.ondragenter = event => {\n        event.preventDefault();\n    };\n    attrs.ondragleave = () => {\n        this.fishDragOver = false;\n    };\n}\n\nfunction addAreaToComponent(component: any, viewName: string, modelProperty: string) {\n    if (viewName === 'content') {\n        override(component, viewName, function (content) {\n            return content().concat(movingFishContent(this.fishDragOver, this.attrs[modelProperty]));\n        });\n    } else {\n        extend(component, viewName, function (items: ItemList) {\n            items.add('catchthefish-fish-and-drop', movingFishContent(this.fishDragOver, this.attrs[modelProperty]));\n        });\n    }\n\n    extend(component, 'oninit', function () {\n        this.fishDragOver = false;\n\n        // Add a condition to the post tree retainer\n        if (this.subtree) {\n            this.subtree.check(() => this.fishDragOver);\n        }\n    });\n\n    if (viewName === 'content') {\n        // CommentPost has an attrs() method we can extend\n        extend(component, 'elementAttrs', function (attrs) {\n            addDropAttrs.bind(this)(attrs, modelProperty);\n        });\n    } else {\n        // For other elements we manually add attrs to the vdom of the view\n        extend(component, 'view', function (vdom) {\n            vdom.attrs = vdom.attrs || {};\n            addDropAttrs.bind(this)(vdom.attrs, modelProperty);\n        });\n    }\n}\n\nexport default function () {\n    addAreaToComponent(CommentPost.prototype, 'content', 'post');\n    addAreaToComponent(UserCard.prototype, 'infoItems', 'user');\n    addAreaToComponent(DiscussionHero.prototype, 'items', 'discussion');\n}\n","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport User from './User';\nimport Ranking from '../models/Ranking';\nimport Round from '../models/Round';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.table-ranking.';\n\ninterface RoundRankingsAttrs {\n    round: Round\n}\n\nexport default class RoundRankings implements ClassComponent<RoundRankingsAttrs> {\n    rankings: Ranking[] | null = null;\n\n    oninit(vnode: Vnode<RoundRankingsAttrs, this>) {\n        app.request({\n            method: 'GET',\n            url: app.forum.attribute('apiUrl') + '/catch-the-fish/rounds/' + vnode.attrs.round.id() + '/rankings',\n        }).then(result => {\n            this.rankings = app.store.pushPayload(result);\n            m.redraw();\n        });\n    }\n\n    view(vnode: Vnode<RoundRankingsAttrs, this>) {\n        if (this.rankings === null) {\n            return m('p', app.translator.trans(translationPrefix + 'loading'));\n        }\n\n        return m('div', [\n            m('h2', app.translator.trans(translationPrefix + 'title', {\n                name: vnode.attrs.round.name(),\n            })),\n            m('table.catchthefish-table', [\n                m('thead', m('tr', [\n                    m('th', app.translator.trans(translationPrefix + 'rank')),\n                    m('th', app.translator.trans(translationPrefix + 'count')),\n                    m('th', app.translator.trans(translationPrefix + 'user')),\n                ])),\n                m('tbody', this.rankings.map((ranking, index) => m('tr', [\n                    m('td', '#' + (index + 1)),\n                    m('td', ranking.catch_count()),\n                    m('td', m(User, {\n                        user: ranking.user(),\n                    })),\n                ]))),\n            ]),\n        ]);\n    }\n}\n","import app from 'flarum/forum/app';\nimport Page from 'flarum/common/components/Page';\nimport RoundRankings from \"../components/RoundRankings\";\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.page-ranking.';\n\nexport default class Rankings extends Page {\n    view() {\n        if (!app.forum.catchTheFishCanSeeRankingsPage()) {\n            return m('.container', m('p', app.translator.trans(translationPrefix + 'permission')));\n        }\n\n        const rounds = app.forum.catchTheFishActiveRounds();\n\n        return m('.container', [\n            m('h2', app.translator.trans(translationPrefix + 'title')),\n            rounds ? rounds.map(round => m(RoundRankings, {\n                round,\n            })) : m('p', app.translator.trans(translationPrefix + 'nothing')),\n        ]);\n    }\n}\n","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport Button from 'flarum/common/components/Button';\nimport Switch from 'flarum/common/components/Switch';\nimport extractText from 'flarum/common/utils/extractText';\nimport withAttr from 'flarum/common/utils/withAttr';\nimport Round from '../models/Round';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.edit-round.';\n\ninterface EditRoundAttrs {\n    round?: Round\n    onsave?: () => void\n    ondelete?: () => void\n}\n\nexport default class EditRound implements ClassComponent<EditRoundAttrs> {\n    round!: Round\n    dirty: boolean = false\n    processing: boolean = false\n\n    oninit(vnode: Vnode<EditRoundAttrs, this>) {\n        let {round} = vnode.attrs;\n\n        if (typeof round === 'undefined') {\n            round = app.store.createRecord('catchthefish-rounds', {\n                attributes: {\n                    name: '',\n                    starts_at: '',\n                    ends_at: dayjs().add(1, 'day').toISOString(),\n                    include_starting_pack: true,\n                },\n            }) as Round;\n        }\n\n        this.round = round;\n    }\n\n    view(vnode: Vnode<EditRoundAttrs, this>) {\n        return m('form', {\n            onsubmit: (event: Event) => {\n                event.preventDefault();\n                this.saveRecord(vnode);\n            },\n        }, [\n            m('.Form-group', [\n                m('label', app.translator.trans(translationPrefix + 'name')),\n                m('input.FormControl', {\n                    value: this.round.name(),\n                    oninput: withAttr('value', this.updateAttribute.bind(this, 'name')),\n                }),\n                m('.helpText', app.translator.trans(translationPrefix + 'name-help')),\n            ]),\n            m('.Form-group', [\n                m('label', app.translator.trans(translationPrefix + 'starts-at')),\n                m('input.FormControl', {\n                    value: this.round.starts_at(),\n                    oninput: withAttr('value', this.updateAttribute.bind(this, 'starts_at')),\n                }),\n            ]),\n            m('.Form-group', [\n                m('label', app.translator.trans(translationPrefix + 'ends-at')),\n                m('input.FormControl', {\n                    value: this.round.ends_at(),\n                    oninput: withAttr('value', this.updateAttribute.bind(this, 'ends_at')),\n                }),\n            ]),\n            this.round.exists ? '' : m('.Form-group', [\n                m('label', [\n                    Switch.component({\n                        state: this.round.include_starting_pack(),\n                        onchange: this.updateAttribute.bind(this, 'include_starting_pack'),\n                    }, app.translator.trans(translationPrefix + 'starting-pack')),\n                ]),\n                m('.helpText', app.translator.trans(translationPrefix + 'starting-pack-help')),\n            ]),\n            m('.ButtonGroup', [\n                Button.component({\n                    type: 'submit',\n                    className: 'Button Button--primary',\n                    loading: this.processing,\n                    disabled: !this.readyToSave(),\n                }, app.translator.trans(translationPrefix + (this.round.exists ? 'save' : 'create'))),\n                (this.round.exists ? Button.component({\n                    type: 'button',\n                    className: 'Button Button--danger',\n                    loading: this.processing,\n                    onclick: () => {\n                        this.deleteRecord(vnode);\n                    },\n                }, app.translator.trans(translationPrefix + 'delete')) : ''),\n            ]),\n        ]);\n    }\n\n    updateAttribute(attribute: string, value: any) {\n        this.round.pushAttributes({\n            [attribute]: value,\n        });\n\n        this.dirty = true;\n    }\n\n    readyToSave() {\n        if (!this.round.name()) {\n            return false;\n        }\n\n        return this.dirty;\n    }\n\n    saveRecord(vnode: Vnode<EditRoundAttrs, this>) {\n        this.processing = true;\n\n        this.round.save(this.round.data.attributes).then(() => {\n            if (vnode.attrs.onsave) {\n                vnode.attrs.onsave();\n            }\n\n            this.processing = false;\n            this.dirty = false;\n            m.redraw();\n        }).catch(err => {\n            this.processing = false;\n            m.redraw();\n            throw err;\n        });\n    }\n\n    deleteRecord(vnode: Vnode<EditRoundAttrs, this>) {\n        if (!confirm(extractText(app.translator.trans(translationPrefix + 'delete-confirmation', {\n            name: this.round.name(),\n        })))) {\n            return;\n        }\n\n        this.processing = true;\n\n        this.round.delete().then(() => {\n            if (vnode.attrs.ondelete) {\n                vnode.attrs.ondelete();\n            }\n\n            this.processing = false;\n            m.redraw();\n        }).catch(err => {\n            this.processing = false;\n            m.redraw();\n            throw err;\n        });\n    }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport EditRound from '../components/EditRound';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.new-round-modal.';\n\nexport default class NewRoundModal extends Modal {\n    className() {\n        return 'Modal--small';\n    }\n\n    title() {\n        return app.translator.trans(translationPrefix + 'title');\n    }\n\n    content() {\n        return m('.Modal-body', m(EditRound, {\n            onsave: () => {\n                this.hide();\n\n                if (this.attrs.oncreateordelete) {\n                    this.attrs.oncreateordelete();\n                }\n            },\n        }));\n    }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport EditRound from '../components/EditRound';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.edit-round-modal.';\n\nexport default class EditRoundModal extends Modal {\n    className() {\n        return 'Modal--small';\n    }\n\n    title() {\n        return app.translator.trans(translationPrefix + 'title', {\n            name: this.attrs.round.name(),\n        });\n    }\n\n    content() {\n        return m('.Modal-body', m(EditRound, {\n            round: this.attrs.round,\n            ondelete: () => {\n                this.hide();\n\n                if (this.attrs.oncreateordelete) {\n                    this.attrs.oncreateordelete();\n                }\n            },\n        }));\n    }\n}\n","import {Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport Page from 'flarum/common/components/Page';\nimport Button from 'flarum/common/components/Button';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport NewRoundModal from '../modals/NewRoundModal';\nimport EditRoundModal from '../modals/EditRoundModal';\nimport Round from '../models/Round';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.table-round.';\n\nexport default class RoundList extends Page {\n    rounds: Round[] | null = null\n\n    oninit(vnode: Vnode) {\n        super.oninit(vnode);\n\n        this.refreshRounds();\n    }\n\n    refreshRounds() {\n        this.rounds = null;\n\n        app.request({\n            method: 'GET',\n            url: app.forum.attribute('apiUrl') + '/catch-the-fish/rounds',\n        }).then(result => {\n            this.rounds = app.store.pushPayload(result);\n            m.redraw();\n        });\n    }\n\n    view() {\n        if (this.rounds === null) {\n            return m('.container', m('p', app.translator.trans(translationPrefix + 'loading')));\n        }\n\n        return m('.container', [\n            m('h2', app.translator.trans(translationPrefix + 'title')),\n            Button.component({\n                className: 'Button Button--primary',\n                onclick: () => {\n                    app.modal.show(NewRoundModal, {\n                        oncreateordelete: () => {\n                            this.refreshRounds();\n                        },\n                    });\n                },\n            }, app.translator.trans(translationPrefix + 'new')),\n            m('table.catchthefish-table', [\n                m('thead', m('tr', [\n                    m('th', app.translator.trans(translationPrefix + 'name')),\n                    m('th', app.translator.trans(translationPrefix + 'start')),\n                    m('th', app.translator.trans(translationPrefix + 'end')),\n                    m('th', app.translator.trans(translationPrefix + 'actions')),\n                ])),\n                m('tbody', this.rounds.map(round => m('tr', [\n                    m('td', round.name()),\n                    m('td', round.starts_at()),\n                    m('td', round.ends_at()),\n                    m('td', [\n                        Button.component({\n                            className: 'Button',\n                            onclick: () => {\n                                app.modal.show(EditRoundModal, {\n                                    round,\n                                    oncreateordelete: () => {\n                                        this.refreshRounds();\n                                    },\n                                });\n                            },\n                        }, app.translator.trans(translationPrefix + 'edit')),\n                        ' ',\n                        LinkButton.component({\n                            className: 'Button',\n                            href: app.route('catchTheFishRound', {\n                                id: round.id(),\n                            }),\n                        }, app.translator.trans(translationPrefix + 'fishes')),\n                    ]),\n                ]))),\n            ]),\n        ]);\n    }\n}\n","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport Button from 'flarum/common/components/Button';\nimport extractText from 'flarum/common/utils/extractText';\nimport Fish from '../models/Fish';\nimport Round from '../models/Round';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.edit-fish.';\n\ninterface EditFishAttrs {\n    fish?: Fish\n    round: Round\n    onsave?: () => void\n    ondelete?: () => void\n}\n\nexport default class EditFish implements ClassComponent<EditFishAttrs> {\n    fish!: Fish\n    dirty: boolean = false\n    processing: boolean = false\n\n    oninit(vnode: Vnode<EditFishAttrs, this>) {\n        let {fish} = vnode.attrs;\n        if (typeof fish === 'undefined') {\n            fish = app.store.createRecord('catchthefish-fishes', {\n                attributes: {\n                    round_id: vnode.attrs.round.id(),\n                    name: '',\n                },\n            }) as Fish;\n        }\n\n        this.fish = fish;\n    }\n\n    view(vnode: Vnode<EditFishAttrs, this>) {\n        return m('form', {\n            onsubmit: (event: Event) => {\n                event.preventDefault();\n                this.saveRecord(vnode);\n            },\n        }, [\n            m('.Form-group', [\n                m('label', app.translator.trans(translationPrefix + 'name')),\n                m('input.FormControl', {\n                    value: this.fish.name(),\n                    oninput: (event: Event) => {\n                        this.fish.pushAttributes({\n                            name: (event.target as HTMLInputElement).value,\n                        });\n\n                        this.dirty = true;\n                    },\n                }),\n                m('.helpText', app.translator.trans(translationPrefix + 'name-help')),\n            ]),\n            m('.ButtonGroup', [\n                Button.component({\n                    type: 'submit',\n                    className: 'Button Button--primary',\n                    loading: this.processing,\n                    disabled: !this.readyToSave(),\n                }, app.translator.trans(translationPrefix + (this.fish.exists ? 'save' : 'create'))),\n                (this.fish.exists ? Button.component({\n                    type: 'button',\n                    className: 'Button Button--danger',\n                    loading: this.processing,\n                    onclick: () => {\n                        this.deleteRecord(vnode);\n                    },\n                }, app.translator.trans(translationPrefix + 'delete')) : ''),\n            ]),\n        ]);\n    }\n\n    readyToSave() {\n        if (!this.fish.name()) {\n            return false;\n        }\n\n        return this.dirty;\n    }\n\n    saveRecord(vnode: Vnode<EditFishAttrs, this>) {\n        this.processing = true;\n\n        this.fish.save(this.fish.data.attributes).then(() => {\n            if (vnode.attrs.onsave) {\n                vnode.attrs.onsave();\n            }\n\n            this.processing = false;\n            this.dirty = false;\n            m.redraw();\n        }).catch(err => {\n            this.processing = false;\n            m.redraw();\n            throw err;\n        });\n    }\n\n    deleteRecord(vnode: Vnode<EditFishAttrs, this>) {\n        if (!confirm(extractText(app.translator.trans(translationPrefix + 'delete-confirmation', {\n            name: this.fish.name(),\n        })))) {\n            return;\n        }\n\n        this.processing = true;\n\n        this.fish.delete().then(() => {\n            if (vnode.attrs.ondelete) {\n                vnode.attrs.ondelete();\n            }\n\n            this.processing = false;\n            m.redraw();\n        }).catch(err => {\n            this.processing = false;\n            m.redraw();\n            throw err;\n        });\n    }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport EditFish from '../components/EditFish';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.new-fish-modal.';\n\nexport default class NewFishModal extends Modal {\n    className() {\n        return 'Modal--small';\n    }\n\n    title() {\n        return app.translator.trans(translationPrefix + 'title');\n    }\n\n    content() {\n        return m('.Modal-body', m(EditFish, {\n            round: this.attrs.round,\n            onsave: () => {\n                this.hide();\n\n                if (this.attrs.oncreateordelete) {\n                    this.attrs.oncreateordelete();\n                }\n            },\n        }));\n    }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport EditFish from '../components/EditFish';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.edit-fish-modal.';\n\nexport default class EditRoundModal extends Modal {\n    className() {\n        return 'Modal--small';\n    }\n\n    title() {\n        return app.translator.trans(translationPrefix + 'title', {\n            name: this.attrs.fish.name(),\n        });\n    }\n\n    content() {\n        return m('.Modal-body', m(EditFish, {\n            fish: this.attrs.fish,\n            ondelete: () => {\n                this.hide();\n\n                if (this.attrs.oncreateordelete) {\n                    this.attrs.oncreateordelete();\n                }\n            },\n        }));\n    }\n}\n","import {Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport Page from 'flarum/common/components/Page';\nimport Button from 'flarum/common/components/Button';\nimport NewFishModal from '../modals/NewFishModal';\nimport EditFishModal from '../modals/EditFishModal';\nimport FishImage from '../components/FishImage';\nimport User from '../components/User';\nimport Fish from '../models/Fish';\nimport Round from '../models/Round';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.table-fish.';\n\nexport default class RoundSettings extends Page {\n    roundId!: string\n    round: Round | null = null\n    fishes: Fish[] | null = null\n    uploading: boolean = false\n\n    oninit(vnode: Vnode) {\n        super.oninit(vnode);\n\n        this.roundId = m.route.param('id');\n        this.round = app.store.getById('catchthefish-round', this.roundId);\n\n        if (!this.round) {\n            app.store.find('catch-the-fish/rounds', this.roundId).then(round => {\n                this.round = round;\n                m.redraw();\n            });\n        }\n\n        this.refreshFishes();\n    }\n\n    refreshFishes() {\n        this.fishes = null;\n\n        app.request({\n            method: 'GET',\n            url: app.forum.attribute('apiUrl') + '/catch-the-fish/rounds/' + this.roundId + '/fishes',\n        }).then(result => {\n            this.fishes = app.store.pushPayload(result);\n            m.redraw();\n        });\n    }\n\n    // Based on Flarum's AvatarEditor component\n    openPicker(callback: (files: FileList) => void, multiple = false) {\n        if (this.uploading) return;\n\n        const $input = $('<input type=\"file\">');\n        // @ts-ignore should the variable be cast to string?\n        $input.attr('multiple', multiple);\n        $input.appendTo('body').hide().click().on('change', event => {\n            callback((event.target as HTMLInputElement).files as FileList);\n        });\n    }\n\n    uploadImages(images: FileList, fish?: Fish) {\n        const body = new FormData();\n\n        if (fish) {\n            body.append('image', images[0]);\n        } else {\n            for (let i = 0; i < images.length; i++) {\n                body.append('image' + i, images[i]);\n            }\n        }\n\n        this.uploading = true;\n        m.redraw();\n\n        app.request({\n            method: 'POST',\n            url: app.forum.attribute('apiUrl') + '/catch-the-fish/' + (fish ? 'fishes/' + fish.id() + '/image' : 'rounds/' + this.roundId + '/fishes-from-images'),\n            serialize: (raw: any) => raw,\n            body,\n        }).then(() => {\n            this.uploading = false;\n            m.redraw();\n            this.refreshFishes();\n        }).catch(err => {\n            this.uploading = false;\n            m.redraw();\n            throw err;\n        });\n    }\n\n    view() {\n        if (!this.round || this.fishes === null) {\n            return m('.container', m('p', app.translator.trans(translationPrefix + 'loading')));\n        }\n\n        return m('.container', [\n            m('h2', app.translator.trans(translationPrefix + 'title', {\n                name: this.round.name(),\n            })),\n            Button.component({\n                className: 'Button Button--primary',\n                onclick: () => {\n                    app.modal.show(NewFishModal, {\n                        round: this.round,\n                        oncreateordelete: () => {\n                            this.refreshFishes();\n                        },\n                    });\n                },\n            }, app.translator.trans(translationPrefix + 'new')),\n            ' ',\n            Button.component({\n                className: 'Button',\n                type: 'button',\n                onclick: () => {\n                    this.openPicker(files => {\n                        this.uploadImages(files);\n                    }, true);\n                },\n                loading: this.uploading,\n            }, app.translator.trans(translationPrefix + 'new-from-image')),\n            m('table.catchthefish-table', [\n                m('thead', m('tr', [\n                    m('th', app.translator.trans(translationPrefix + 'image')),\n                    m('th', app.translator.trans(translationPrefix + 'name')),\n                    m('th', app.translator.trans(translationPrefix + 'user-name')),\n                    m('th', app.translator.trans(translationPrefix + 'user-place')),\n                    m('th', app.translator.trans(translationPrefix + 'actions')),\n                ])),\n                m('tbody', this.fishes.length === 0 ? m('tr', [\n                    m('td', 'No fishes'),\n                ]) : this.fishes.map(fish => {\n                    const namedBy = fish.namedBy();\n                    const placedBy = fish.namedBy();\n\n                    return m('tr', [\n                        m('td', m(FishImage, {\n                            fish,\n                        })),\n                        m('td', fish.name()),\n                        m('td', namedBy ? m(User, {\n                            user: namedBy,\n                        }) : m('em', app.translator.trans(translationPrefix + 'no-user-name'))),\n                        m('td', placedBy ? m(User, {\n                            user: placedBy,\n                        }) : m('em', app.translator.trans(translationPrefix + 'no-user-place'))),\n                        m('td', [\n                            Button.component({\n                                className: 'Button',\n                                onclick: () => {\n                                    app.modal.show(EditFishModal, {\n                                        fish,\n                                        oncreateordelete: () => {\n                                            this.refreshFishes();\n                                        },\n                                    });\n                                },\n                            }, app.translator.trans(translationPrefix + 'edit')),\n                            ' ',\n                            Button.component({\n                                className: 'Button',\n                                type: 'button',\n                                onclick: () => {\n                                    this.openPicker(files => {\n                                        this.uploadImages(files, fish);\n                                    });\n                                },\n                                loading: this.uploading,\n                            }, app.translator.trans(translationPrefix + 'upload')),\n                        ]),\n                    ]);\n                })),\n            ]),\n        ]);\n    }\n}\n","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport Round from '../models/Round';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.round-alert.';\n\ninterface UpdateAlertAttrs {\n    round: Round\n}\n\nexport default class UpdateAlert implements ClassComponent<UpdateAlertAttrs> {\n    view(vnode: Vnode<UpdateAlertAttrs, this>) {\n        return m('.Alert.Alert-info', m('.container', [\n            m('span.Alert-body', [\n                app.translator.trans(translationPrefix + 'message', {\n                    name: vnode.attrs.round.name(),\n                    time: dayjs(vnode.attrs.round.ends_at()).calendar(),\n                }),\n            ]),\n            app.forum.catchTheFishCanSeeRankingsPage() ? m('ul.Alert-controls', m('li', LinkButton.component({\n                href: app.route('catchTheFishRankings'),\n            }, app.translator.trans(translationPrefix + 'rankings')))) : null,\n        ]));\n    }\n}\n","import app from 'flarum/forum/app';\nimport addModels from './addModels';\nimport addFishBasket from './addFishBasket';\nimport addDropAreas from './addDropAreas';\nimport addPages from './addPages';\nimport addNavLinks from './addNavLinks';\nimport addRoundAlert from './addRoundAlert';\nimport calendar from 'dayjs/plugin/calendar';\n\n// Import calendar plugin for Day.js\ndayjs.extend(calendar)\n\napp.initializers.add('clarkwinkelmann-catch-the-fish', () => {\n    addModels();\n    addFishBasket();\n    addDropAreas();\n    addPages();\n    addNavLinks();\n    addRoundAlert();\n});\n","import app from 'flarum/forum/app';\nimport Model from 'flarum/common/Model';\nimport Discussion from 'flarum/common/models/Discussion';\nimport Post from 'flarum/common/models/Post';\nimport User from 'flarum/common/models/User';\nimport Forum from 'flarum/common/models/Forum';\nimport Fish from './models/Fish';\nimport Ranking from './models/Ranking';\nimport Round from './models/Round';\n\nexport default function () {\n    app.store.models['catchthefish-fishes'] = Fish;\n    app.store.models['catchthefish-rankings'] = Ranking;\n    app.store.models['catchthefish-rounds'] = Round;\n\n    Discussion.prototype.catchTheFishFishes = Model.hasMany('catchTheFishFishes');\n    Post.prototype.catchTheFishFishes = Model.hasMany('catchTheFishFishes');\n    User.prototype.catchTheFishFishes = Model.hasMany('catchTheFishFishes');\n    User.prototype.catchTheFishBasket = Model.hasMany('catchTheFishBasket');\n    Forum.prototype.catchTheFishActiveRounds = Model.hasMany('catchTheFishActiveRounds');\n    Forum.prototype.catchTheFishCanModerate = Model.attribute('catchTheFishCanModerate');\n    Forum.prototype.catchTheFishCanSeeRankingsPage = Model.attribute('catchTheFishCanSeeRankingsPage');\n    Forum.prototype.catchTheFishCanSeeProfileRankings = Model.attribute('catchTheFishCanSeeProfileRankings');\n    Forum.prototype.catchTheFishAnimateFlip = Model.attribute('catchTheFishAnimateFlip');\n}\n","import {extend} from 'flarum/common/extend';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport HeaderPrimary from 'flarum/forum/components/HeaderPrimary';\nimport Basket from './components/Basket';\n\nexport default function () {\n    extend(HeaderPrimary.prototype, 'items', function (items: ItemList) {\n        items.add('catchthefish-basket', m(Basket));\n    });\n}\n","import app from 'flarum/forum/app';\nimport Rankings from \"./pages/Rankings\";\nimport RoundList from './pages/RoundList';\nimport RoundSettings from './pages/RoundSettings';\n\nexport default function () {\n    app.routes.catchTheFishRankings = {\n        path: '/catch-the-fish',\n        component: Rankings,\n    };\n\n    app.routes.catchTheFishRounds = {\n        path: '/catch-the-fish/rounds',\n        component: RoundList,\n    };\n\n    app.routes.catchTheFishRound = {\n        path: '/catch-the-fish/rounds/:id',\n        component: RoundSettings,\n    };\n}\n","import {extend} from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport ItemList from 'flarum/common/utils/ItemList';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.nav.';\n\nexport default function () {\n    extend(IndexPage.prototype, 'navItems', function (items: ItemList) {\n        if (app.forum.catchTheFishCanSeeRankingsPage()) {\n            items.add('catchthefish-rankings', LinkButton.component({\n                icon: 'fas fa-fish',\n                href: app.route('catchTheFishRankings'),\n            }, app.translator.trans(translationPrefix + 'rankings')));\n        }\n\n        if (app.forum.catchTheFishCanModerate()) {\n            items.add('catchthefish-settings', LinkButton.component({\n                icon: 'fas fa-fish',\n                href: app.route('catchTheFishRounds'),\n            }, app.translator.trans(translationPrefix + 'settings')));\n        }\n    });\n}\n","import {override} from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport RoundAlert from './components/RoundAlert';\n\nexport default function () {\n    override(IndexPage.prototype, 'hero', function (original: any) {\n        const existing = original();\n\n        const rounds = app.forum.catchTheFishActiveRounds();\n\n        if (!rounds) {\n            return existing;\n        }\n\n        // Replace missing rounds with null. Happens if you delete a round and go back to homepage\n        const additional = rounds.map(round => round ? m(RoundAlert, {\n            round,\n        }) : null);\n\n        if (Array.isArray(existing)) {\n            return rounds.concat(existing);\n        }\n\n        return m('div', [\n            additional,\n            existing,\n        ]);\n    });\n}\n"],"sourceRoot":""}