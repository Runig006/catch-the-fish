{"version":3,"sources":["webpack://@clarkwinkelmann/catch-the-fish/webpack/bootstrap","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['forum/app']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/Model']\"","webpack://@clarkwinkelmann/catch-the-fish/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@clarkwinkelmann/catch-the-fish/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/components/Button']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/extend']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/components/Modal']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/components/LinkButton']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/utils/extractText']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/components/Page']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/components/Switch']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/models/Forum']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/models/User']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/components/Link']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/models/Discussion']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/models/Post']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/utils/withAttr']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['forum/components/HeaderPrimary']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['forum/components/CommentPost']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['forum/components/UserCard']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['forum/components/DiscussionHero']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/utils/classList']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/helpers/avatar']\"","webpack://@clarkwinkelmann/catch-the-fish/external \"flarum.core.compat['common/helpers/username']\"","webpack://@clarkwinkelmann/catch-the-fish/./node_modules/dayjs/plugin/calendar.js","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/models/Fish.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/models/Ranking.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/models/Round.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/FishImage.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/Basket.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/DropArea.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/User.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/modals/CaughtFishModal.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/MovingFish.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/addDropAreas.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/RoundRankings.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/pages/Rankings.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/EditRound.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/modals/NewRoundModal.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/modals/EditRoundModal.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/pages/RoundList.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/EditFish.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/modals/NewFishModal.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/modals/EditFishModal.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/pages/RoundSettings.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/components/RoundAlert.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/index.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/addModels.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/addFishBasket.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/addPages.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/addNavLinks.ts","webpack://@clarkwinkelmann/catch-the-fish/./src/forum/addRoundAlert.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","flarum","core","compat","_setPrototypeOf","setPrototypeOf","__proto__","_inheritsLoose","subClass","superClass","constructor","e","a","lastDay","sameDay","nextDay","nextWeek","lastWeek","sameElse","calendar","this","$locale","startOf","diff","f","format","Fish","round_id","Model","attribute","placement","image_url","canSee","canCatch","canName","canPlace","placeUntil","namedBy","hasOne","placedBy","round","placementModel","apiEndpoint","exists","data","id","attributes","Ranking","catch_count","user","Round","starts_at","ends_at","include_starting_pack","ranking","FishImage","view","vnode","src","attrs","fish","alt","extractText","app","translator","trans","translationPrefix","style","animationDuration","Basket","session","basket","catchTheFishBasket","fishesThatCanBePlaced","filter","length","map","draggable","ondragstart","event","dataTransfer","setData","time","dayjs","fromNow","DropArea","User","Link","href","route","avatar","username","CaughtFishModal","newName","dirty","loading","oninit","className","title","saveNameAndPlacement","randomPlacement","body","request","method","url","forum","then","result","store","pushPayload","hide","find","redraw","err","content","oninput","target","Button","component","type","onclick","onsubmit","preventDefault","Modal","MovingFish","reverseAnimation","Math","random","floor","classList","catchTheFishAnimateFlip","modal","show","oncatch","alert","fishIdFromEvent","getData","match","exec","movingFishContent","dragover","model","push","fishes","catchTheFishFishes","forEach","pushData","relationships","addDropAttrs","modelProperty","ondrop","fishDragOver","fishId","getById","ondragover","dropEffect","ondragenter","ondragleave","addAreaToComponent","viewName","override","concat","extend","items","add","subtree","check","vdom","RoundRankings","rankings","index","Rankings","catchTheFishCanSeeRankingsPage","rounds","catchTheFishActiveRounds","Page","EditRound","processing","createRecord","toISOString","saveRecord","withAttr","updateAttribute","Switch","state","onchange","disabled","readyToSave","deleteRecord","pushAttributes","save","onsave","confirm","ondelete","NewRoundModal","oncreateordelete","EditRoundModal","RoundList","refreshRounds","LinkButton","EditFish","NewFishModal","RoundSettings","roundId","uploading","param","refreshFishes","openPicker","callback","multiple","$input","$","attr","appendTo","click","on","files","uploadImages","images","FormData","append","serialize","raw","EditFishModal","Discussion","discussion","Post","post","number","UserModel","UpdateAlert","initializers","models","hasMany","Forum","catchTheFishCanModerate","catchTheFishCanSeeProfileRankings","HeaderPrimary","CommentPost","UserCard","DiscussionHero","routes","catchTheFishRankings","path","catchTheFishRounds","catchTheFishRound","IndexPage","icon","original","existing","additional","RoundAlert","Array","isArray"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 29);\n","module.exports = flarum.core.compat['forum/app'];","module.exports = flarum.core.compat['common/Model'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","module.exports = flarum.core.compat['common/components/Button'];","module.exports = flarum.core.compat['common/extend'];","module.exports = flarum.core.compat['common/components/Modal'];","module.exports = flarum.core.compat['common/components/LinkButton'];","module.exports = flarum.core.compat['common/utils/extractText'];","module.exports = flarum.core.compat['common/components/Page'];","module.exports = flarum.core.compat['common/components/Switch'];","module.exports = flarum.core.compat['common/models/Forum'];","module.exports = flarum.core.compat['common/models/User'];","module.exports = flarum.core.compat['common/components/Link'];","module.exports = flarum.core.compat['common/models/Discussion'];","module.exports = flarum.core.compat['common/models/Post'];","module.exports = flarum.core.compat['forum/components/IndexPage'];","module.exports = flarum.core.compat['common/utils/withAttr'];","module.exports = flarum.core.compat['forum/components/HeaderPrimary'];","module.exports = flarum.core.compat['forum/components/CommentPost'];","module.exports = flarum.core.compat['forum/components/UserCard'];","module.exports = flarum.core.compat['forum/components/DiscussionHero'];","module.exports = flarum.core.compat['common/utils/classList'];","module.exports = flarum.core.compat['common/helpers/avatar'];","module.exports = flarum.core.compat['common/helpers/username'];","!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):(e=\"undefined\"!=typeof globalThis?globalThis:e||self).dayjs_plugin_calendar=t()}(this,(function(){\"use strict\";return function(e,t,a){var n=\"h:mm A\",d={lastDay:\"[Yesterday at] \"+n,sameDay:\"[Today at] \"+n,nextDay:\"[Tomorrow at] \"+n,nextWeek:\"dddd [at] \"+n,lastWeek:\"[Last] dddd [at] \"+n,sameElse:\"MM/DD/YYYY\"};t.prototype.calendar=function(e,t){var n=t||this.$locale().calendar||d,o=a(e||void 0).startOf(\"d\"),s=this.diff(o,\"d\",!0),i=\"sameElse\",f=s<-6?i:s<-1?\"lastWeek\":s<0?\"lastDay\":s<1?\"sameDay\":s<2?\"nextDay\":s<7?\"nextWeek\":i,l=n[f]||d[f];return\"function\"==typeof l?l.call(this,a()):this.format(l)}}}));","import Model from 'flarum/common/Model';\nimport User from 'flarum/common/models/User';\n\nexport default class Fish extends Model {\n    round_id = Model.attribute('round_id'); // Just for the creation apiEndpoint creation\n    placement = Model.attribute('placement'); // Object\n    name = Model.attribute('name');\n    image_url = Model.attribute('image_url');\n    canSee = Model.attribute('canSee');\n    canCatch = Model.attribute('canCatch');\n    canName = Model.attribute('canName');\n    canPlace = Model.attribute('canPlace');\n    placeUntil = Model.attribute('placeUntil');\n    namedBy: () => User | false = Model.hasOne('lastUserNaming');\n    placedBy: () => User | false = Model.hasOne('lastUserPlacement');\n    round = Model.hasOne('round');\n    placementModel = Model.hasOne('placement'); // Only used by the admin panel to show the link to the resource\n\n    apiEndpoint() {\n        return '/catch-the-fish/' + (this.exists ? 'fishes/' + this.data.id : 'rounds/' + this.data.attributes.round_id + '/fishes');\n    }\n}\n","import Model from 'flarum/common/Model';\nimport User from 'flarum/common/models/User';\n\nexport default class Ranking extends Model {\n    catch_count = Model.attribute('catch_count');\n    user: () => User = Model.hasOne('user');\n}\n","import Model from 'flarum/common/Model';\n\nexport default class Round extends Model {\n    name = Model.attribute('name');\n    starts_at = Model.attribute('starts_at');\n    ends_at = Model.attribute('ends_at');\n    include_starting_pack = Model.attribute('include_starting_pack');\n    ranking = Model.hasOne('ranking');\n\n    apiEndpoint() {\n        return '/catch-the-fish/rounds' + (this.exists ? '/' + this.data.id : '');\n    }\n}\n","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport extractText from 'flarum/common/utils/extractText';\nimport Fish from '../models/Fish';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.fish-image.';\n\ninterface FishImageAttrs {\n    fish: Fish\n    animationDuration?: string\n}\n\nexport default class FishImage implements ClassComponent<FishImageAttrs> {\n    view(vnode: Vnode<FishImageAttrs, this>) {\n        const src = vnode.attrs.fish.image_url();\n\n        if (src) {\n            return m('img.catchthefish-image', {\n                alt: extractText(app.translator.trans(translationPrefix + 'alt', {\n                    name: vnode.attrs.fish.name(),\n                })),\n                src,\n                style: {\n                    animationDuration: vnode.attrs.animationDuration || '10s',\n                },\n            });\n        }\n\n        return m('.catchthefish-no-image', app.translator.trans(translationPrefix + 'missing'));\n    }\n}\n","import {ClassComponent} from 'mithril';\nimport app from 'flarum/forum/app';\nimport User from 'flarum/common/models/User';\nimport FishImage from './FishImage';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.basket.';\n\nexport default class Basket implements ClassComponent {\n    view() {\n        if (!app.session.user) {\n            return m('div');\n        }\n\n        const basket = (app.session.user as User).catchTheFishBasket();\n\n        if (!basket) {\n            return m('div');\n        }\n\n        const fishesThatCanBePlaced = basket.filter(fish => fish.canPlace());\n\n        if (fishesThatCanBePlaced.length === 0) {\n            return m('div');\n        }\n\n        return m('.catchthefish-basket', [\n            m('.catchthefish-basket-title', app.translator.trans(translationPrefix + 'title')),\n            m('p', app.translator.trans(translationPrefix + 'drag-help')),\n            fishesThatCanBePlaced.map(fish => m('.catchthefish-basket-entry', [\n                m('.catchthefish-basket-fish', {\n                    draggable: true,\n                    ondragstart(event: DragEvent) {\n                        if (!event.dataTransfer) {\n                            return;\n                        }\n\n                        event.dataTransfer.setData('text/plain', 'fish:' + fish.id());\n                    },\n                }, m(FishImage, {\n                    fish,\n                })),\n                m('.catchthefish-basket-time', app.translator.trans(translationPrefix + 'time', {\n                    time: dayjs(fish.placeUntil()).fromNow(),\n                })),\n            ])),\n        ]);\n    }\n}\n","import {ClassComponent} from 'mithril';\nimport app from 'flarum/forum/app';\n\nexport default class DropArea implements ClassComponent {\n    view() {\n        return m('.catchthefish-drop-area', app.translator.trans('clarkwinkelmann-catch-the-fish.forum.drop-area.message'));\n    }\n}\n","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport Link from 'flarum/common/components/Link';\nimport avatar from 'flarum/common/helpers/avatar';\nimport username from 'flarum/common/helpers/username';\nimport UserModel from 'flarum/common/models/User';\n\ninterface UserAttrs {\n    user: UserModel\n}\n\nexport default class User implements ClassComponent<UserAttrs> {\n    view(vnode: Vnode<UserAttrs, this>) {\n        const {user} = vnode.attrs;\n\n        return m(Link, {\n            href: app.route.user(user),\n        }, [\n            avatar(user),\n            ' ',\n            username(user),\n        ]);\n    }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport FishImage from '../components/FishImage';\nimport User from \"../components/User\";\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.caught-fish-modal.';\n\nexport default class CaughtFishModal extends Modal {\n    newName!: string\n    dirty: boolean = false\n    loading: boolean = false\n\n    oninit(vnode) {\n        super.oninit(vnode);\n\n        this.newName = this.attrs.fish.name();\n    }\n\n    className() {\n        return 'Modal--small catchthefish-catch-modal';\n    }\n\n    title() {\n        return app.translator.trans(translationPrefix + 'title');\n    }\n\n    saveNameAndPlacement(randomPlacement = false) {\n        const body: any = {};\n\n        if (this.dirty) {\n            body.name = this.newName;\n        }\n\n        if (randomPlacement) {\n            body.placement = 'random';\n        }\n\n        if (body) {\n            this.loading = true;\n\n            app.request({\n                method: 'POST',\n                url: app.forum.attribute('apiUrl') + '/catch-the-fish/fishes/' + this.attrs.fish.id() + '/place',\n                body,\n            }).then(result => {\n                app.store.pushPayload(result);\n                this.hide();\n\n                if (this.attrs.fish.canPlace() && !randomPlacement) {\n                    // Refresh basket by reloading user\n                    app.store.find('users', app.session.user.id()).then(() => {\n                        m.redraw();\n                    });\n                }\n            }).catch(err => {\n                this.loading = false;\n                m.redraw();\n                throw err;\n            });\n        } else {\n            this.hide();\n\n            if (this.attrs.fish.canPlace() && !randomPlacement) {\n                // Refresh basket by reloading user\n                app.store.find('users', app.session.user.id()).then(() => {\n                    m.redraw();\n                });\n            }\n        }\n    }\n\n    content() {\n        const {fish} = this.attrs;\n\n        const namedBy = fish.namedBy();\n        const placedBy = fish.placedBy();\n\n        return m('.Modal-body', [\n            m('h3', '\"' + fish.name() + '\"'),\n            m(FishImage, {\n                fish,\n            }),\n            namedBy ? m('p', [\n                app.translator.trans(translationPrefix + 'named-by'),\n                ' ',\n                m(User, {\n                    user: namedBy,\n                }),\n            ]) : null,\n            placedBy ? m('p', [\n                app.translator.trans(translationPrefix + 'placed-by'),\n                ' ',\n                m(User, {\n                    user: placedBy,\n                }),\n            ]) : null,\n            m('p', app.translator.trans(translationPrefix + 'congratulation', {\n                catch_count: fish.round().ranking().catch_count(),\n            })),\n            fish.canName() ? m('.Form-group', [\n                m('p', app.translator.trans(translationPrefix + 'name-help')),\n                m('label', app.translator.trans(translationPrefix + 'name')),\n                m('input.FormControl', {\n                    value: this.newName,\n                    oninput: event => {\n                        this.newName = event.target.value;\n                        this.dirty = true;\n                    },\n                }),\n            ]) : null,\n            fish.canPlace() ? m('p', app.translator.trans(translationPrefix + 'placement-help')) : null,\n            m('.Form-group', Button.component({\n                className: 'Button Button--primary Button--block',\n                type: 'button',\n                loading: this.loading,\n                onclick: () => {\n                    this.saveNameAndPlacement();\n                },\n            }, app.translator.trans(translationPrefix + (this.dirty ? (fish.canPlace() ? 'submit-name-place-later' : 'submit-name') : (fish.canPlace() ? 'submit-place-later' : 'submit-continue'))))),\n            fish.canPlace() ? m('.Form-group', Button.component({\n                className: 'Button Button--primary Button--block',\n                type: 'button',\n                loading: this.loading,\n                onclick: () => {\n                    this.saveNameAndPlacement(true);\n                },\n            }, app.translator.trans(translationPrefix + (this.dirty ? 'submit-name-place-random' : 'submit-place-random')))) : null,\n        ]);\n    }\n\n    onsubmit(event) {\n        event.preventDefault();\n        // Because the modal has its own form, pressing enter will submit here\n        // In this case we apply the same feature as the first button\n        this.saveNameAndPlacement();\n    }\n}\n","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport classList from 'flarum/common/utils/classList';\nimport FishImage from './FishImage';\nimport CaughtFishModal from '../modals/CaughtFishModal';\nimport Fish from '../models/Fish';\n\ninterface MovingFishAttrs {\n    fish: Fish\n    oncatch?: () => void\n}\n\nexport default class MovingFish implements ClassComponent<MovingFishAttrs> {\n    reverseAnimation!: boolean\n    animationDuration!: string\n\n    oninit() {\n        this.reverseAnimation = Math.random() > 0.5;\n        this.animationDuration = 5 + (Math.floor(Math.random() * 70) / 10) + 's';\n    }\n\n    view(vnode: Vnode<MovingFishAttrs, this>) {\n        const {fish} = vnode.attrs;\n\n        return m('.catchthefish-moving-fish', {\n            className: classList({\n                'catchthefish-animate-flip': app.forum.catchTheFishAnimateFlip(),\n                'catchthefish-animate-reverse': this.reverseAnimation,\n            }),\n            style: {\n                animationDuration: this.animationDuration,\n            },\n            onclick: () => {\n                if (!fish.canCatch() && !app.session.user) {\n                    alert(app.translator.trans('clarkwinkelmann-catch-the-fish.forum.moving-fish.login'));\n                    return;\n                }\n\n                app.request({\n                    method: 'POST',\n                    url: app.forum.attribute('apiUrl') + '/catch-the-fish/fishes/' + fish.id() + '/catch',\n                    body: fish.placement(),\n                }).then(result => {\n                    app.modal.show(CaughtFishModal, {\n                        fish: app.store.pushPayload(result),\n                    });\n\n                    // So the parent can remove the fish from the relationship\n                    if (vnode.attrs.oncatch) {\n                        vnode.attrs.oncatch();\n                    }\n                });\n            },\n        }, [\n            m('.catchthefish-name', fish.name()),\n            m(FishImage, {\n                fish,\n                animationDuration: this.animationDuration,\n            }),\n        ]);\n    }\n}\n","import {extend, override} from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport CommentPost from 'flarum/forum/components/CommentPost';\nimport UserCard from 'flarum/forum/components/UserCard';\nimport DiscussionHero from 'flarum/forum/components/DiscussionHero';\nimport DropArea from './components/DropArea';\nimport MovingFish from './components/MovingFish';\n\nfunction fishIdFromEvent(event: DragEvent): string | null {\n    if (!event.dataTransfer) {\n        return null;\n    }\n\n    const data = event.dataTransfer.getData(\"text/plain\");\n\n    const match = /^fish:([0-9]+)$/.exec(data);\n\n    return match ? match[1] : null;\n}\n\nfunction movingFishContent(dragover: boolean, model) {\n    const content = [];\n\n    if (dragover) {\n        content.push(m(DropArea));\n    }\n\n    const fishes = model.catchTheFishFishes();\n\n    if (fishes) {\n        fishes.forEach(fish => {\n            if (!fish.canSee()) {\n                return;\n            }\n\n            // Remove fish from relationship\n            content.push(m(MovingFish, {\n                fish,\n                oncatch: () => {\n                    model.pushData({\n                        relationships: {\n                            catchTheFishFishes: {\n                                data: model.data.relationships.catchTheFishFishes.data.filter(f => f.id !== fish.id()),\n                            },\n                        },\n                    });\n                },\n            }));\n        });\n    }\n\n    return content;\n}\n\nfunction addDropAttrs(attrs, modelProperty) {\n    attrs.ondrop = event => {\n        this.fishDragOver = false;\n        const fishId = fishIdFromEvent(event);\n\n        if (fishId) {\n            event.preventDefault();\n\n            const fish = app.store.getById('catchthefish-fishes', fishId);\n\n            if (fish) {\n                const placement = {};\n                placement[modelProperty + '_id'] = this.attrs[modelProperty].id();\n\n                app.request({\n                    method: 'POST',\n                    url: app.forum.attribute('apiUrl') + '/catch-the-fish/fishes/' + fish.id() + '/place',\n                    body: {\n                        placement,\n                    },\n                }).then(result => {\n                    app.store.pushPayload(result);\n\n                    // Refresh basket by reloading user\n                    app.store.find('users', app.session.user.id()).then(() => {\n                        m.redraw();\n                    });\n                });\n            } else {\n                alert(app.translator.trans('clarkwinkelmann-catch-the-fish.forum.drop-area.missing-from-store'));\n            }\n        }\n    };\n    attrs.ondragover = event => {\n        const fishId = fishIdFromEvent(event);\n\n        if (fishId) {\n            event.preventDefault();\n            event.dataTransfer.dropEffect = 'move';\n            this.fishDragOver = true;\n        }\n    };\n    attrs.ondragenter = event => {\n        event.preventDefault();\n    };\n    attrs.ondragleave = () => {\n        this.fishDragOver = false;\n    };\n}\n\nfunction addAreaToComponent(component: any, viewName: string, modelProperty: string) {\n    if (viewName === 'content') {\n        override(component, viewName, function (content) {\n            return content().concat(movingFishContent(this.fishDragOver, this.attrs[modelProperty]));\n        });\n    } else {\n        extend(component, viewName, function (items: ItemList) {\n            items.add('catchthefish-fish-and-drop', movingFishContent(this.fishDragOver, this.attrs[modelProperty]));\n        });\n    }\n\n    extend(component, 'oninit', function () {\n        this.fishDragOver = false;\n\n        // Add a condition to the post tree retainer\n        if (this.subtree) {\n            this.subtree.check(() => this.fishDragOver);\n        }\n    });\n\n    if (viewName === 'content') {\n        // CommentPost has an attrs() method we can extend\n        extend(component, 'elementAttrs', function (attrs) {\n            addDropAttrs.bind(this)(attrs, modelProperty);\n        });\n    } else {\n        // For other elements we manually add attrs to the vdom of the view\n        extend(component, 'view', function (vdom) {\n            vdom.attrs = vdom.attrs || {};\n            addDropAttrs.bind(this)(vdom.attrs, modelProperty);\n        });\n    }\n}\n\nexport default function () {\n    addAreaToComponent(CommentPost.prototype, 'content', 'post');\n    addAreaToComponent(UserCard.prototype, 'infoItems', 'user');\n    addAreaToComponent(DiscussionHero.prototype, 'items', 'discussion');\n}\n","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport User from './User';\nimport Ranking from '../models/Ranking';\nimport Round from '../models/Round';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.table-ranking.';\n\ninterface RoundRankingsAttrs {\n    round: Round\n}\n\nexport default class RoundRankings implements ClassComponent<RoundRankingsAttrs> {\n    rankings: Ranking[] | null = null;\n\n    oninit(vnode: Vnode<RoundRankingsAttrs, this>) {\n        app.request({\n            method: 'GET',\n            url: app.forum.attribute('apiUrl') + '/catch-the-fish/rounds/' + vnode.attrs.round.id() + '/rankings',\n        }).then(result => {\n            this.rankings = app.store.pushPayload(result);\n            m.redraw();\n        });\n    }\n\n    view(vnode: Vnode<RoundRankingsAttrs, this>) {\n        if (this.rankings === null) {\n            return m('p', app.translator.trans(translationPrefix + 'loading'));\n        }\n\n        return m('div', [\n            m('h2', app.translator.trans(translationPrefix + 'title', {\n                name: vnode.attrs.round.name(),\n            })),\n            m('table.catchthefish-table', [\n                m('thead', m('tr', [\n                    m('th', app.translator.trans(translationPrefix + 'rank')),\n                    m('th', app.translator.trans(translationPrefix + 'count')),\n                    m('th', app.translator.trans(translationPrefix + 'user')),\n                ])),\n                m('tbody', this.rankings.map((ranking, index) => m('tr', [\n                    m('td', '#' + (index + 1)),\n                    m('td', ranking.catch_count()),\n                    m('td', m(User, {\n                        user: ranking.user(),\n                    })),\n                ]))),\n            ]),\n        ]);\n    }\n}\n","import app from 'flarum/forum/app';\nimport Page from 'flarum/common/components/Page';\nimport RoundRankings from \"../components/RoundRankings\";\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.page-ranking.';\n\nexport default class Rankings extends Page {\n    view() {\n        if (!app.forum.catchTheFishCanSeeRankingsPage()) {\n            return m('.container', m('p', app.translator.trans(translationPrefix + 'permission')));\n        }\n\n        const rounds = app.forum.catchTheFishActiveRounds();\n\n        return m('.container', [\n            m('h2', app.translator.trans(translationPrefix + 'title')),\n            rounds ? rounds.map(round => m(RoundRankings, {\n                round,\n            })) : m('p', app.translator.trans(translationPrefix + 'nothing')),\n        ]);\n    }\n}\n","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport Button from 'flarum/common/components/Button';\nimport Switch from 'flarum/common/components/Switch';\nimport extractText from 'flarum/common/utils/extractText';\nimport withAttr from 'flarum/common/utils/withAttr';\nimport Round from '../models/Round';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.edit-round.';\n\ninterface EditRoundAttrs {\n    round?: Round\n    onsave?: () => void\n    ondelete?: () => void\n}\n\nexport default class EditRound implements ClassComponent<EditRoundAttrs> {\n    round!: Round\n    dirty: boolean = false\n    processing: boolean = false\n\n    oninit(vnode: Vnode<EditRoundAttrs, this>) {\n        let {round} = vnode.attrs;\n\n        if (typeof round === 'undefined') {\n            round = app.store.createRecord('catchthefish-rounds', {\n                attributes: {\n                    name: '',\n                    starts_at: '',\n                    ends_at: dayjs().add(1, 'day').toISOString(),\n                    include_starting_pack: true,\n                },\n            }) as Round;\n        }\n\n        this.round = round;\n    }\n\n    view(vnode: Vnode<EditRoundAttrs, this>) {\n        return m('form', {\n            onsubmit: (event: Event) => {\n                event.preventDefault();\n                this.saveRecord(vnode);\n            },\n        }, [\n            m('.Form-group', [\n                m('label', app.translator.trans(translationPrefix + 'name')),\n                m('input.FormControl', {\n                    value: this.round.name(),\n                    oninput: withAttr('value', this.updateAttribute.bind(this, 'name')),\n                }),\n                m('.helpText', app.translator.trans(translationPrefix + 'name-help')),\n            ]),\n            m('.Form-group', [\n                m('label', app.translator.trans(translationPrefix + 'starts-at')),\n                m('input.FormControl', {\n                    value: this.round.starts_at(),\n                    oninput: withAttr('value', this.updateAttribute.bind(this, 'starts_at')),\n                }),\n            ]),\n            m('.Form-group', [\n                m('label', app.translator.trans(translationPrefix + 'ends-at')),\n                m('input.FormControl', {\n                    value: this.round.ends_at(),\n                    oninput: withAttr('value', this.updateAttribute.bind(this, 'ends_at')),\n                }),\n            ]),\n            this.round.exists ? '' : m('.Form-group', [\n                m('label', [\n                    Switch.component({\n                        state: this.round.include_starting_pack(),\n                        onchange: this.updateAttribute.bind(this, 'include_starting_pack'),\n                    }, app.translator.trans(translationPrefix + 'starting-pack')),\n                ]),\n                m('.helpText', app.translator.trans(translationPrefix + 'starting-pack-help')),\n            ]),\n            m('.ButtonGroup', [\n                Button.component({\n                    type: 'submit',\n                    className: 'Button Button--primary',\n                    loading: this.processing,\n                    disabled: !this.readyToSave(),\n                }, app.translator.trans(translationPrefix + (this.round.exists ? 'save' : 'create'))),\n                (this.round.exists ? Button.component({\n                    type: 'button',\n                    className: 'Button Button--danger',\n                    loading: this.processing,\n                    onclick: () => {\n                        this.deleteRecord(vnode);\n                    },\n                }, app.translator.trans(translationPrefix + 'delete')) : ''),\n            ]),\n        ]);\n    }\n\n    updateAttribute(attribute: string, value: any) {\n        this.round.pushAttributes({\n            [attribute]: value,\n        });\n\n        this.dirty = true;\n    }\n\n    readyToSave() {\n        if (!this.round.name()) {\n            return false;\n        }\n\n        return this.dirty;\n    }\n\n    saveRecord(vnode: Vnode<EditRoundAttrs, this>) {\n        this.processing = true;\n\n        this.round.save(this.round.data.attributes).then(() => {\n            if (vnode.attrs.onsave) {\n                vnode.attrs.onsave();\n            }\n\n            this.processing = false;\n            this.dirty = false;\n            m.redraw();\n        }).catch(err => {\n            this.processing = false;\n            m.redraw();\n            throw err;\n        });\n    }\n\n    deleteRecord(vnode: Vnode<EditRoundAttrs, this>) {\n        if (!confirm(extractText(app.translator.trans(translationPrefix + 'delete-confirmation', {\n            name: this.round.name(),\n        })))) {\n            return;\n        }\n\n        this.processing = true;\n\n        this.round.delete().then(() => {\n            if (vnode.attrs.ondelete) {\n                vnode.attrs.ondelete();\n            }\n\n            this.processing = false;\n            m.redraw();\n        }).catch(err => {\n            this.processing = false;\n            m.redraw();\n            throw err;\n        });\n    }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport EditRound from '../components/EditRound';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.new-round-modal.';\n\nexport default class NewRoundModal extends Modal {\n    className() {\n        return 'Modal--small';\n    }\n\n    title() {\n        return app.translator.trans(translationPrefix + 'title');\n    }\n\n    content() {\n        return m('.Modal-body', m(EditRound, {\n            onsave: () => {\n                this.hide();\n\n                if (this.attrs.oncreateordelete) {\n                    this.attrs.oncreateordelete();\n                }\n            },\n        }));\n    }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport EditRound from '../components/EditRound';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.edit-round-modal.';\n\nexport default class EditRoundModal extends Modal {\n    className() {\n        return 'Modal--small';\n    }\n\n    title() {\n        return app.translator.trans(translationPrefix + 'title', {\n            name: this.attrs.round.name(),\n        });\n    }\n\n    content() {\n        return m('.Modal-body', m(EditRound, {\n            round: this.attrs.round,\n            ondelete: () => {\n                this.hide();\n\n                if (this.attrs.oncreateordelete) {\n                    this.attrs.oncreateordelete();\n                }\n            },\n        }));\n    }\n}\n","import {Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport Page from 'flarum/common/components/Page';\nimport Button from 'flarum/common/components/Button';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport NewRoundModal from '../modals/NewRoundModal';\nimport EditRoundModal from '../modals/EditRoundModal';\nimport Round from '../models/Round';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.table-round.';\n\nexport default class RoundList extends Page {\n    rounds: Round[] | null = null\n\n    oninit(vnode: Vnode) {\n        super.oninit(vnode);\n\n        this.refreshRounds();\n    }\n\n    refreshRounds() {\n        this.rounds = null;\n\n        app.request({\n            method: 'GET',\n            url: app.forum.attribute('apiUrl') + '/catch-the-fish/rounds',\n        }).then(result => {\n            this.rounds = app.store.pushPayload(result);\n            m.redraw();\n        });\n    }\n\n    view() {\n        if (this.rounds === null) {\n            return m('.container', m('p', app.translator.trans(translationPrefix + 'loading')));\n        }\n\n        return m('.container', [\n            m('h2', app.translator.trans(translationPrefix + 'title')),\n            Button.component({\n                className: 'Button Button--primary',\n                onclick: () => {\n                    app.modal.show(NewRoundModal, {\n                        oncreateordelete: () => {\n                            this.refreshRounds();\n                        },\n                    });\n                },\n            }, app.translator.trans(translationPrefix + 'new')),\n            m('table.catchthefish-table', [\n                m('thead', m('tr', [\n                    m('th', app.translator.trans(translationPrefix + 'name')),\n                    m('th', app.translator.trans(translationPrefix + 'start')),\n                    m('th', app.translator.trans(translationPrefix + 'end')),\n                    m('th', app.translator.trans(translationPrefix + 'actions')),\n                ])),\n                m('tbody', this.rounds.map(round => m('tr', [\n                    m('td', round.name()),\n                    m('td', round.starts_at()),\n                    m('td', round.ends_at()),\n                    m('td', [\n                        Button.component({\n                            className: 'Button',\n                            onclick: () => {\n                                app.modal.show(EditRoundModal, {\n                                    round,\n                                    oncreateordelete: () => {\n                                        this.refreshRounds();\n                                    },\n                                });\n                            },\n                        }, app.translator.trans(translationPrefix + 'edit')),\n                        ' ',\n                        LinkButton.component({\n                            className: 'Button',\n                            href: app.route('catchTheFishRound', {\n                                id: round.id(),\n                            }),\n                        }, app.translator.trans(translationPrefix + 'fishes')),\n                    ]),\n                ]))),\n            ]),\n        ]);\n    }\n}\n","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport Button from 'flarum/common/components/Button';\nimport extractText from 'flarum/common/utils/extractText';\nimport Fish from '../models/Fish';\nimport Round from '../models/Round';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.edit-fish.';\n\ninterface EditFishAttrs {\n    fish?: Fish\n    round: Round\n    onsave?: () => void\n    ondelete?: () => void\n}\n\nexport default class EditFish implements ClassComponent<EditFishAttrs> {\n    fish!: Fish\n    dirty: boolean = false\n    processing: boolean = false\n\n    oninit(vnode: Vnode<EditFishAttrs, this>) {\n        let {fish} = vnode.attrs;\n        if (typeof fish === 'undefined') {\n            fish = app.store.createRecord('catchthefish-fishes', {\n                attributes: {\n                    round_id: vnode.attrs.round.id(),\n                    name: '',\n                },\n            }) as Fish;\n        }\n\n        this.fish = fish;\n    }\n\n    view(vnode: Vnode<EditFishAttrs, this>) {\n        return m('form', {\n            onsubmit: (event: Event) => {\n                event.preventDefault();\n                this.saveRecord(vnode);\n            },\n        }, [\n            m('.Form-group', [\n                m('label', app.translator.trans(translationPrefix + 'name')),\n                m('input.FormControl', {\n                    value: this.fish.name(),\n                    oninput: (event: Event) => {\n                        this.fish.pushAttributes({\n                            name: (event.target as HTMLInputElement).value,\n                        });\n\n                        this.dirty = true;\n                    },\n                }),\n                m('.helpText', app.translator.trans(translationPrefix + 'name-help')),\n            ]),\n            m('.ButtonGroup', [\n                Button.component({\n                    type: 'submit',\n                    className: 'Button Button--primary',\n                    loading: this.processing,\n                    disabled: !this.readyToSave(),\n                }, app.translator.trans(translationPrefix + (this.fish.exists ? 'save' : 'create'))),\n                (this.fish.exists ? Button.component({\n                    type: 'button',\n                    className: 'Button Button--danger',\n                    loading: this.processing,\n                    onclick: () => {\n                        this.deleteRecord(vnode);\n                    },\n                }, app.translator.trans(translationPrefix + 'delete')) : ''),\n            ]),\n        ]);\n    }\n\n    readyToSave() {\n        if (!this.fish.name()) {\n            return false;\n        }\n\n        return this.dirty;\n    }\n\n    saveRecord(vnode: Vnode<EditFishAttrs, this>) {\n        this.processing = true;\n\n        this.fish.save(this.fish.data.attributes).then(() => {\n            if (vnode.attrs.onsave) {\n                vnode.attrs.onsave();\n            }\n\n            this.processing = false;\n            this.dirty = false;\n            m.redraw();\n        }).catch(err => {\n            this.processing = false;\n            m.redraw();\n            throw err;\n        });\n    }\n\n    deleteRecord(vnode: Vnode<EditFishAttrs, this>) {\n        if (!confirm(extractText(app.translator.trans(translationPrefix + 'delete-confirmation', {\n            name: this.fish.name(),\n        })))) {\n            return;\n        }\n\n        this.processing = true;\n\n        this.fish.delete().then(() => {\n            if (vnode.attrs.ondelete) {\n                vnode.attrs.ondelete();\n            }\n\n            this.processing = false;\n            m.redraw();\n        }).catch(err => {\n            this.processing = false;\n            m.redraw();\n            throw err;\n        });\n    }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport EditFish from '../components/EditFish';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.new-fish-modal.';\n\nexport default class NewFishModal extends Modal {\n    className() {\n        return 'Modal--small';\n    }\n\n    title() {\n        return app.translator.trans(translationPrefix + 'title');\n    }\n\n    content() {\n        return m('.Modal-body', m(EditFish, {\n            round: this.attrs.round,\n            onsave: () => {\n                this.hide();\n\n                if (this.attrs.oncreateordelete) {\n                    this.attrs.oncreateordelete();\n                }\n            },\n        }));\n    }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport EditFish from '../components/EditFish';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.edit-fish-modal.';\n\nexport default class EditRoundModal extends Modal {\n    className() {\n        return 'Modal--small';\n    }\n\n    title() {\n        return app.translator.trans(translationPrefix + 'title', {\n            name: this.attrs.fish.name(),\n        });\n    }\n\n    content() {\n        return m('.Modal-body', m(EditFish, {\n            fish: this.attrs.fish,\n            ondelete: () => {\n                this.hide();\n\n                if (this.attrs.oncreateordelete) {\n                    this.attrs.oncreateordelete();\n                }\n            },\n        }));\n    }\n}\n","import {Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport Link from 'flarum/common/components/Link';\nimport Page from 'flarum/common/components/Page';\nimport Button from 'flarum/common/components/Button';\nimport Discussion from 'flarum/common/models/Discussion';\nimport Post from 'flarum/common/models/Post';\nimport UserModel from 'flarum/common/models/User';\nimport NewFishModal from '../modals/NewFishModal';\nimport EditFishModal from '../modals/EditFishModal';\nimport FishImage from '../components/FishImage';\nimport User from '../components/User';\nimport Fish from '../models/Fish';\nimport Round from '../models/Round';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.table-fish.';\n\nexport default class RoundSettings extends Page {\n    roundId!: string\n    round: Round | null = null\n    fishes: Fish[] | null = null\n    uploading: boolean = false\n\n    oninit(vnode: Vnode) {\n        super.oninit(vnode);\n\n        this.roundId = m.route.param('id');\n        this.round = app.store.getById('catchthefish-round', this.roundId);\n\n        if (!this.round) {\n            app.store.find('catch-the-fish/rounds', this.roundId).then(round => {\n                this.round = round;\n                m.redraw();\n            });\n        }\n\n        this.refreshFishes();\n    }\n\n    refreshFishes() {\n        this.fishes = null;\n\n        app.request({\n            method: 'GET',\n            url: app.forum.attribute('apiUrl') + '/catch-the-fish/rounds/' + this.roundId + '/fishes',\n        }).then(result => {\n            this.fishes = app.store.pushPayload(result);\n            m.redraw();\n        });\n    }\n\n    // Based on Flarum's AvatarEditor component\n    openPicker(callback: (files: FileList) => void, multiple = false) {\n        if (this.uploading) return;\n\n        const $input = $('<input type=\"file\">');\n        // @ts-ignore should the variable be cast to string?\n        $input.attr('multiple', multiple);\n        $input.appendTo('body').hide().click().on('change', event => {\n            callback((event.target as HTMLInputElement).files as FileList);\n        });\n    }\n\n    uploadImages(images: FileList, fish?: Fish) {\n        const body = new FormData();\n\n        if (fish) {\n            body.append('image', images[0]);\n        } else {\n            for (let i = 0; i < images.length; i++) {\n                body.append('image' + i, images[i]);\n            }\n        }\n\n        this.uploading = true;\n        m.redraw();\n\n        app.request({\n            method: 'POST',\n            url: app.forum.attribute('apiUrl') + '/catch-the-fish/' + (fish ? 'fishes/' + fish.id() + '/image' : 'rounds/' + this.roundId + '/fishes-from-images'),\n            serialize: (raw: any) => raw,\n            body,\n        }).then(() => {\n            this.uploading = false;\n            m.redraw();\n            this.refreshFishes();\n        }).catch(err => {\n            this.uploading = false;\n            m.redraw();\n            throw err;\n        });\n    }\n\n    view() {\n        if (!this.round || this.fishes === null) {\n            return m('.container', m('p', app.translator.trans(translationPrefix + 'loading')));\n        }\n\n        return m('.container', [\n            m('h2', app.translator.trans(translationPrefix + 'title', {\n                name: this.round.name(),\n            })),\n            Button.component({\n                className: 'Button Button--primary',\n                onclick: () => {\n                    app.modal.show(NewFishModal, {\n                        round: this.round,\n                        oncreateordelete: () => {\n                            this.refreshFishes();\n                        },\n                    });\n                },\n            }, app.translator.trans(translationPrefix + 'new')),\n            ' ',\n            Button.component({\n                className: 'Button',\n                type: 'button',\n                onclick: () => {\n                    this.openPicker(files => {\n                        this.uploadImages(files);\n                    }, true);\n                },\n                loading: this.uploading,\n            }, app.translator.trans(translationPrefix + 'new-from-image')),\n            m('table.catchthefish-table', [\n                m('thead', m('tr', [\n                    m('th', app.translator.trans(translationPrefix + 'image')),\n                    m('th', app.translator.trans(translationPrefix + 'name')),\n                    m('th', app.translator.trans(translationPrefix + 'user-name')),\n                    m('th', app.translator.trans(translationPrefix + 'user-place')),\n                    m('th', app.translator.trans(translationPrefix + 'placement')),\n                    m('th', app.translator.trans(translationPrefix + 'actions')),\n                ])),\n                m('tbody', this.fishes.length === 0 ? m('tr', [\n                    m('td', 'No fishes'),\n                ]) : this.fishes.map(fish => {\n                    const namedBy = fish.namedBy();\n                    const placedBy = fish.placedBy();\n\n                    return m('tr', [\n                        m('td', m(FishImage, {\n                            fish,\n                        })),\n                        m('td', fish.name()),\n                        m('td', namedBy ? m(User, {\n                            user: namedBy,\n                        }) : m('em', app.translator.trans(translationPrefix + 'no-user-name'))),\n                        m('td', placedBy ? m(User, {\n                            user: placedBy,\n                        }) : m('em', app.translator.trans(translationPrefix + 'no-user-place'))),\n                        m('td', this.placement(fish)),\n                        m('td', [\n                            Button.component({\n                                className: 'Button',\n                                onclick: () => {\n                                    app.modal.show(EditFishModal, {\n                                        fish,\n                                        oncreateordelete: () => {\n                                            this.refreshFishes();\n                                        },\n                                    });\n                                },\n                            }, app.translator.trans(translationPrefix + 'edit')),\n                            ' ',\n                            Button.component({\n                                className: 'Button',\n                                type: 'button',\n                                onclick: () => {\n                                    this.openPicker(files => {\n                                        this.uploadImages(files, fish);\n                                    });\n                                },\n                                loading: this.uploading,\n                            }, app.translator.trans(translationPrefix + 'upload')),\n                        ]),\n                    ]);\n                })),\n            ]),\n        ]);\n    }\n\n    placement(fish: Fish): any {\n        const placement = fish.placementModel();\n\n        if (placement instanceof Discussion) {\n            return m(Link, {\n                href: app.route.discussion(placement),\n            }, placement.title());\n        }\n\n        if (placement instanceof Post) {\n            const discussion = placement.discussion();\n\n            return m(Link, {\n                href: app.route.post(placement),\n            }, (discussion ? discussion.title() : '') + ' #' + placement.number());\n        }\n\n        if (placement instanceof UserModel) {\n            return m(User, {\n                user: placement,\n            });\n        }\n\n        return 'N/A';\n    }\n}\n","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport Round from '../models/Round';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.round-alert.';\n\ninterface UpdateAlertAttrs {\n    round: Round\n}\n\nexport default class UpdateAlert implements ClassComponent<UpdateAlertAttrs> {\n    view(vnode: Vnode<UpdateAlertAttrs, this>) {\n        return m('.Alert.Alert-info', m('.container', [\n            m('span.Alert-body', [\n                app.translator.trans(translationPrefix + 'message', {\n                    name: vnode.attrs.round.name(),\n                    time: dayjs(vnode.attrs.round.ends_at()).calendar(),\n                }),\n            ]),\n            app.forum.catchTheFishCanSeeRankingsPage() ? m('ul.Alert-controls', m('li', LinkButton.component({\n                href: app.route('catchTheFishRankings'),\n            }, app.translator.trans(translationPrefix + 'rankings')))) : null,\n        ]));\n    }\n}\n","import app from 'flarum/forum/app';\nimport addModels from './addModels';\nimport addFishBasket from './addFishBasket';\nimport addDropAreas from './addDropAreas';\nimport addPages from './addPages';\nimport addNavLinks from './addNavLinks';\nimport addRoundAlert from './addRoundAlert';\nimport calendar from 'dayjs/plugin/calendar';\n\n// Import calendar plugin for Day.js\ndayjs.extend(calendar)\n\napp.initializers.add('clarkwinkelmann-catch-the-fish', () => {\n    addModels();\n    addFishBasket();\n    addDropAreas();\n    addPages();\n    addNavLinks();\n    addRoundAlert();\n});\n","import app from 'flarum/forum/app';\nimport Model from 'flarum/common/Model';\nimport Discussion from 'flarum/common/models/Discussion';\nimport Post from 'flarum/common/models/Post';\nimport User from 'flarum/common/models/User';\nimport Forum from 'flarum/common/models/Forum';\nimport Fish from './models/Fish';\nimport Ranking from './models/Ranking';\nimport Round from './models/Round';\n\nexport default function () {\n    app.store.models['catchthefish-fishes'] = Fish;\n    app.store.models['catchthefish-rankings'] = Ranking;\n    app.store.models['catchthefish-rounds'] = Round;\n\n    Discussion.prototype.catchTheFishFishes = Model.hasMany('catchTheFishFishes');\n    Post.prototype.catchTheFishFishes = Model.hasMany('catchTheFishFishes');\n    User.prototype.catchTheFishFishes = Model.hasMany('catchTheFishFishes');\n    User.prototype.catchTheFishBasket = Model.hasMany('catchTheFishBasket');\n    Forum.prototype.catchTheFishActiveRounds = Model.hasMany('catchTheFishActiveRounds');\n    Forum.prototype.catchTheFishCanModerate = Model.attribute('catchTheFishCanModerate');\n    Forum.prototype.catchTheFishCanSeeRankingsPage = Model.attribute('catchTheFishCanSeeRankingsPage');\n    Forum.prototype.catchTheFishCanSeeProfileRankings = Model.attribute('catchTheFishCanSeeProfileRankings');\n    Forum.prototype.catchTheFishAnimateFlip = Model.attribute('catchTheFishAnimateFlip');\n}\n","import {extend} from 'flarum/common/extend';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport HeaderPrimary from 'flarum/forum/components/HeaderPrimary';\nimport Basket from './components/Basket';\n\nexport default function () {\n    extend(HeaderPrimary.prototype, 'items', function (items: ItemList) {\n        items.add('catchthefish-basket', m(Basket));\n    });\n}\n","import app from 'flarum/forum/app';\nimport Rankings from \"./pages/Rankings\";\nimport RoundList from './pages/RoundList';\nimport RoundSettings from './pages/RoundSettings';\n\nexport default function () {\n    app.routes.catchTheFishRankings = {\n        path: '/catch-the-fish',\n        component: Rankings,\n    };\n\n    app.routes.catchTheFishRounds = {\n        path: '/catch-the-fish/rounds',\n        component: RoundList,\n    };\n\n    app.routes.catchTheFishRound = {\n        path: '/catch-the-fish/rounds/:id',\n        component: RoundSettings,\n    };\n}\n","import {extend} from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport ItemList from 'flarum/common/utils/ItemList';\n\nconst translationPrefix = 'clarkwinkelmann-catch-the-fish.forum.nav.';\n\nexport default function () {\n    extend(IndexPage.prototype, 'navItems', function (items: ItemList) {\n        if (app.forum.catchTheFishCanSeeRankingsPage()) {\n            items.add('catchthefish-rankings', LinkButton.component({\n                icon: 'fas fa-fish',\n                href: app.route('catchTheFishRankings'),\n            }, app.translator.trans(translationPrefix + 'rankings')));\n        }\n\n        if (app.forum.catchTheFishCanModerate()) {\n            items.add('catchthefish-settings', LinkButton.component({\n                icon: 'fas fa-fish',\n                href: app.route('catchTheFishRounds'),\n            }, app.translator.trans(translationPrefix + 'settings')));\n        }\n    });\n}\n","import {override} from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport RoundAlert from './components/RoundAlert';\n\nexport default function () {\n    override(IndexPage.prototype, 'hero', function (original: any) {\n        const existing = original();\n\n        const rounds = app.forum.catchTheFishActiveRounds();\n\n        if (!rounds) {\n            return existing;\n        }\n\n        // Replace missing rounds with null. Happens if you delete a round and go back to homepage\n        const additional = rounds.map(round => round ? m(RoundAlert, {\n            round,\n        }) : null);\n\n        if (Array.isArray(existing)) {\n            return rounds.concat(existing);\n        }\n\n        return m('div', [\n            additional,\n            existing,\n        ]);\n    });\n}\n"],"sourceRoot":""}